<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Unveiling Causal Relationships in Time Series Data • patterncausality</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Unveiling Causal Relationships in Time Series Data">
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">patterncausality</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/patterncausality.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced.html">Advanced Pattern Causality: Custom Functions for Tailored Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/dynamic.html">Dynamic Analysis: Pattern Causality in Time Points</a></li>
    <li><a class="dropdown-item" href="../articles/matrix.html">Multiple Series Pattern Causality Analysis: Unveiling System-Wide Interactions</a></li>
    <li><a class="dropdown-item" href="../articles/parallel.html">Parallel Computing in Pattern Causality Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/series.html">Unveiling Causal Relationships in Time Series Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/skstavroglou/pattern_causality/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Unveiling Causal Relationships in Time Series Data</h1>
                        <h4 data-toc-skip class="author">Stavros
Stavroglou, Athanasios Pantelous, Hui Wang</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skstavroglou/pattern_causality/blob/main/vignettes/series.Rmd" class="external-link"><code>vignettes/series.Rmd</code></a></small>
      <div class="d-none name"><code>series.Rmd</code></div>
    </div>

    
    
<p>This vignette demonstrates advanced techniques for examining causal
relationships between time series using the
<code>patterncausality</code> package. We will focus on three key
aspects:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Cross-validation methods:</strong> To rigorously assess the
robustness of our findings, ensuring they are not mere artifacts of the
data.</li>
<li>
<strong>Parameter optimization:</strong> To fine-tune our analysis
for the most accurate and reliable results.</li>
<li>
<strong>Visualization of causality relationships:</strong> To
provide clear and intuitive insights into the causal connections between
time series.</li>
</ol>
<p>Through cross-validation, we aim to understand:</p>
<ul>
<li>
<strong>Reliability of results:</strong> How dependable are our
conclusions?</li>
<li>
<strong>Robustness across different sample sizes:</strong> Do our
findings hold true regardless of the amount of data used?</li>
<li>
<strong>Stability of causality patterns:</strong> Are the identified
causal relationships consistent over time and across different data
subsets?</li>
</ul>
<div class="section level2">
<h2 id="cross-validation-ensuring-the-reliability-of-causal-inference">Cross-Validation: Ensuring the Reliability of Causal Inference<a class="anchor" aria-label="anchor" href="#cross-validation-ensuring-the-reliability-of-causal-inference"></a>
</h2>
<p>To demonstrate the application of cross-validation, we will begin by
importing a climate dataset from the <code>patterncausality</code>
package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/skstavroglou/pattern_causality/" class="external-link">patterncausality</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">climate_indices</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s apply cross-validation to evaluate the robustness of
pattern causality. We will use the Pacific North American (PNA) and
North Atlantic Oscillation (NAO) climate indices as our example time
series.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">PNA</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">NAO</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcCrossValidation.html">pcCrossValidation</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">X</span>, </span>
<span>  Y <span class="op">=</span> <span class="va">Y</span>,  </span>
<span>  numberset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span>, <span class="fl">400</span>, <span class="fl">500</span><span class="op">)</span>,</span>
<span>  E <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  h <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , positive</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         value</span></span>
<span><span class="co">#&gt; 100 0.4444444</span></span>
<span><span class="co">#&gt; 200 0.3157895</span></span>
<span><span class="co">#&gt; 300 0.2739726</span></span>
<span><span class="co">#&gt; 400 0.2912621</span></span>
<span><span class="co">#&gt; 500 0.2812500</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , negative</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         value</span></span>
<span><span class="co">#&gt; 100 0.1666667</span></span>
<span><span class="co">#&gt; 200 0.0877193</span></span>
<span><span class="co">#&gt; 300 0.3424658</span></span>
<span><span class="co">#&gt; 400 0.2330097</span></span>
<span><span class="co">#&gt; 500 0.2500000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , dark</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         value</span></span>
<span><span class="co">#&gt; 100 0.3888889</span></span>
<span><span class="co">#&gt; 200 0.5964912</span></span>
<span><span class="co">#&gt; 300 0.3835616</span></span>
<span><span class="co">#&gt; 400 0.4757282</span></span>
<span><span class="co">#&gt; 500 0.4687500</span></span></code></pre></div>
<p>To better visualize the results, we will use the <code>plot</code>
function to generate a line chart.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>As you can see from the plot, the location of the causality tends to
stabilize as the sample size increases. This indicates that our method
is effective at capturing the underlying patterns and causal connections
within the time series.</p>
<p>In this tutorial, you’ve learned how to use cross-validation to
assess the reliability of time series causality and how to use
visualization tools to better understand the results.</p>
</div>
<div class="section level2">
<h2 id="cross-validation-convergence-of-pattern-causality">Cross-Validation: Convergence of Pattern Causality<a class="anchor" aria-label="anchor" href="#cross-validation-convergence-of-pattern-causality"></a>
</h2>
<p>Now, let’s examine the cross-validation process when the
<code>random</code> parameter is set to <code>FALSE</code>. This
approach uses a systematic sampling method rather than random
sampling.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">PNA</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">NAO</span></span>
<span><span class="va">result_non_random</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcCrossValidation.html">pcCrossValidation</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">X</span>,</span>
<span>  Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  numberset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span>, <span class="fl">400</span>, <span class="fl">500</span><span class="op">)</span>,</span>
<span>  E <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  h <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_non_random</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , positive</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         value</span></span>
<span><span class="co">#&gt; 100 0.2941176</span></span>
<span><span class="co">#&gt; 200 0.2400000</span></span>
<span><span class="co">#&gt; 300 0.2972973</span></span>
<span><span class="co">#&gt; 400 0.2692308</span></span>
<span><span class="co">#&gt; 500 0.3000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , negative</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         value</span></span>
<span><span class="co">#&gt; 100 0.1764706</span></span>
<span><span class="co">#&gt; 200 0.3200000</span></span>
<span><span class="co">#&gt; 300 0.3108108</span></span>
<span><span class="co">#&gt; 400 0.2596154</span></span>
<span><span class="co">#&gt; 500 0.2307692</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , dark</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         value</span></span>
<span><span class="co">#&gt; 100 0.5294118</span></span>
<span><span class="co">#&gt; 200 0.4400000</span></span>
<span><span class="co">#&gt; 300 0.3918919</span></span>
<span><span class="co">#&gt; 400 0.4711538</span></span>
<span><span class="co">#&gt; 500 0.4692308</span></span></code></pre></div>
<p>We can also visualize the results of the non-random
cross-validation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_non_random</span><span class="op">)</span></span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>By comparing the results of the random and non-random
cross-validation, you can gain a deeper understanding of how different
sampling methods affect the stability and reliability of the causality
analysis.</p>
</div>
<div class="section level2">
<h2 id="cross-validation-with-bootstrap-analysis">Cross-Validation with Bootstrap Analysis<a class="anchor" aria-label="anchor" href="#cross-validation-with-bootstrap-analysis"></a>
</h2>
<p>To obtain more robust results and understand the uncertainty in our
causality measures, we can use bootstrap sampling in our
cross-validation analysis. This approach repeatedly samples the data
with replacement and provides statistical summaries of the causality
measures.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">PNA</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">NAO</span></span>
<span><span class="va">result_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcCrossValidation.html">pcCrossValidation</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">X</span>,</span>
<span>  Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  numberset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span>, <span class="fl">400</span>, <span class="fl">500</span><span class="op">)</span>,</span>
<span>  E <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  h <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  random <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="fl">100</span>,  <span class="co"># Perform 100 bootstrap iterations</span></span>
<span>  n_cores <span class="op">=</span> <span class="fl">2</span>       <span class="co"># Use parallel computation</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The bootstrap analysis provides several statistical measures for each
sample size: - Mean: Average causality measure across bootstrap samples
- 5% and 95% quantiles: Confidence intervals for the causality measure -
Median: Central tendency measure robust to outliers</p>
<p>Let’s examine the results:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_boot</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; , , positive</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          mean         5%       95%    median</span></span>
<span><span class="co">#&gt; 100 0.2932435 0.06666667 0.6155678 0.2649123</span></span>
<span><span class="co">#&gt; 200 0.3070867 0.13894112 0.5240341 0.3050089</span></span>
<span><span class="co">#&gt; 300 0.3081313 0.12620555 0.5003086 0.3051619</span></span>
<span><span class="co">#&gt; 400 0.3179996 0.18472715 0.4778685 0.3039216</span></span>
<span><span class="co">#&gt; 500 0.3047876 0.17621646 0.4211272 0.3102190</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , negative</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          mean         5%       95%    median</span></span>
<span><span class="co">#&gt; 100 0.3145063 0.08316667 0.6169683 0.3000000</span></span>
<span><span class="co">#&gt; 200 0.2881246 0.11320755 0.4698767 0.2745098</span></span>
<span><span class="co">#&gt; 300 0.2883745 0.10938193 0.4600210 0.2835586</span></span>
<span><span class="co">#&gt; 400 0.2802853 0.13721034 0.4075634 0.2914722</span></span>
<span><span class="co">#&gt; 500 0.3024525 0.19484127 0.4511469 0.2893295</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , dark</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          mean        5%       95%    median</span></span>
<span><span class="co">#&gt; 100 0.3922502 0.2259091 0.5559028 0.4000000</span></span>
<span><span class="co">#&gt; 200 0.4047886 0.2854286 0.5485188 0.4047619</span></span>
<span><span class="co">#&gt; 300 0.4034941 0.3155392 0.5000000 0.3952053</span></span>
<span><span class="co">#&gt; 400 0.4017151 0.3185367 0.5007426 0.3980398</span></span>
<span><span class="co">#&gt; 500 0.3927599 0.3279239 0.4730948 0.3946609</span></span></code></pre></div>
<p>We can visualize the bootstrap results using the plot function, which
now shows confidence intervals:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_boot</span>, separate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The shaded area in the plot represents the range between the 5th and
95th percentiles of the bootstrap samples, providing a measure of
uncertainty in our causality estimates. The solid line shows the median
value, which is more robust to outliers than the mean.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.stavroglou.com" class="external-link">Stavros Stavroglou</a>, <a href="https://research.monash.edu/en/persons/athanasios-pantelous" class="external-link">Athanasios Pantelous</a>, <a href="https://huiw.org" class="external-link">Hui Wang</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
