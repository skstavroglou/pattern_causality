<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced Pattern Causality: Custom Functions for Tailored Analysis • patterncausality</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced Pattern Causality: Custom Functions for Tailored Analysis">
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">patterncausality</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/patterncausality.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced.html">Advanced Pattern Causality: Custom Functions for Tailored Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/dynamic.html">Dynamic Analysis: Pattern Causality in Time Points</a></li>
    <li><a class="dropdown-item" href="../articles/matrix.html">Multivariate Pattern Causality Analysis: Unveiling System-Wide Interactions</a></li>
    <li><a class="dropdown-item" href="../articles/series.html">Unveiling Causal Relationships in Time Series Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/skstavroglou/pattern_causality/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Advanced Pattern Causality: Custom Functions for Tailored Analysis</h1>
                        <h4 data-toc-skip class="author">Stavros
Stavroglou, Athanasios Pantelous, Hui Wang</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skstavroglou/pattern_causality/blob/main/vignettes/advanced.Rmd" class="external-link"><code>vignettes/advanced.Rmd</code></a></small>
      <div class="d-none name"><code>advanced.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we delve into the advanced capabilities of the
<code>patterncausality</code> package, focusing on how to use custom
functions to tailor the analysis to your specific needs. We’ll explore
how to define your own distance metrics and state space reconstruction
methods, allowing for greater flexibility and control over the causality
analysis.</p>
<div class="section level2">
<h2 id="why-custom-functions">Why Custom Functions?<a class="anchor" aria-label="anchor" href="#why-custom-functions"></a>
</h2>
<p>The <code>patterncausality</code> package provides a robust framework
for analyzing causal relationships, but sometimes, the default settings
might not be ideal for your specific data or research question. Custom
functions allow you to:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Incorporate domain-specific knowledge:</strong> If you have
a unique way of measuring distances or reconstructing state spaces that
is relevant to your field, you can implement it directly.</li>
<li>
<strong>Experiment with novel methods:</strong> You can test new
ideas and approaches for distance calculation or state space
reconstruction.</li>
<li>
<strong>Handle data peculiarities:</strong> If your data has
specific characteristics (e.g., high levels of noise, non-standard
distributions), you can design functions to address these issues.</li>
</ol>
</div>
<div class="section level2">
<h2 id="custom-distance-metric">Custom Distance Metric<a class="anchor" aria-label="anchor" href="#custom-distance-metric"></a>
</h2>
<p>Let’s start by creating a custom distance metric. In this example,
we’ll implement an adaptive distance metric that switches between
Euclidean and Manhattan distances based on the data’s standard
deviation. This can be useful when dealing with data that has varying
scales or distributions.</p>
<p>This function first checks if the input is a matrix, handles NA
values by replacing them with the mean, and then decides whether to use
Euclidean or Manhattan distance based on the standard deviation of the
input data. Finally, it ensures the distance matrix is symmetric and has
a zero diagonal.</p>
</div>
<div class="section level2">
<h2 id="custom-state-space-reconstruction">Custom State Space Reconstruction<a class="anchor" aria-label="anchor" href="#custom-state-space-reconstruction"></a>
</h2>
<p>Next, let’s define a custom state space reconstruction method. Here,
we’ll implement a denoised state space reconstruction using a median
filter to reduce noise in the time series before constructing the state
space.</p>
<p>This function applies a median filter to smooth the input time series
and then constructs the state space matrix. It also handles any
remaining NA values by replacing them with the mean.</p>
</div>
<div class="section level2">
<h2 id="applying-custom-functions">Applying Custom Functions<a class="anchor" aria-label="anchor" href="#applying-custom-functions"></a>
</h2>
<p>Now, let’s see how to use these custom functions in the
<code>pcLightweight</code> function. We’ll load the
<code>climate_indices</code> dataset and apply our custom functions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/skstavroglou/pattern_causality/" class="external-link">patterncausality</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">climate_indices</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example 1: Using only adaptive distance metric</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcLightweight.html">pcLightweight</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">AO</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>,</span>
<span>  Y <span class="op">=</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">AAO</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>,</span>
<span>  E <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  distance_fn <span class="op">=</span> <span class="va">adaptive_distance</span>,</span>
<span>  h <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Result with adaptive distance:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Result with adaptive distance:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Pattern Causality Analysis Results:</span></span>
<span><span class="co">#&gt; Total: 0.3051</span></span>
<span><span class="co">#&gt; Positive: 0.3719</span></span>
<span><span class="co">#&gt; Negative: 0.2036</span></span>
<span><span class="co">#&gt; Dark: 0.4245</span></span>
<span></span>
<span><span class="co"># Example 2: Using only improved state space</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pcLightweight.html">pcLightweight</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">AO</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>,</span>
<span>  Y <span class="op">=</span> <span class="va">climate_indices</span><span class="op">$</span><span class="va">AAO</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>,</span>
<span>  E <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  state_space_fn <span class="op">=</span> <span class="va">denoised_state_space</span>,</span>
<span>  h <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weighted <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"\nResult with denoised state space:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "\nResult with denoised state space:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Pattern Causality Analysis Results:</span></span>
<span><span class="co">#&gt; Total: 0.1808</span></span>
<span><span class="co">#&gt; Positive: 0.2867</span></span>
<span><span class="co">#&gt; Negative: 0.0516</span></span>
<span><span class="co">#&gt; Dark: 0.6617</span></span></code></pre></div>
<p>In the first example, we use the <code>adaptive_distance</code>
function as the <code>distance_fn</code> argument. In the second
example, we use the <code>denoised_state_space</code> function as the
<code>state_space_fn</code> argument.</p>
</div>
<div class="section level2">
<h2 id="comparing-results">Comparing Results<a class="anchor" aria-label="anchor" href="#comparing-results"></a>
</h2>
<p>Finally, let’s compare the results obtained using the custom
functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare results</span></span>
<span><span class="va">compare_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Adaptive Distance"</span>, <span class="st">"Denoised Space"</span><span class="op">)</span>,</span>
<span>  Total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">total</span>, <span class="va">result2</span><span class="op">$</span><span class="va">total</span><span class="op">)</span>,</span>
<span>  Positive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">positive</span>, <span class="va">result2</span><span class="op">$</span><span class="va">positive</span><span class="op">)</span>,</span>
<span>  Negative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">negative</span>, <span class="va">result2</span><span class="op">$</span><span class="va">negative</span><span class="op">)</span>,</span>
<span>  Dark <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result1</span><span class="op">$</span><span class="va">dark</span>, <span class="va">result2</span><span class="op">$</span><span class="va">dark</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"\nComparison of different approaches:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "\nComparison of different approaches:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">compare_results</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Method     Total  Positive   Negative      Dark</span></span>
<span><span class="co">#&gt; 1 Adaptive Distance 0.3050847 0.3718733 0.20362022 0.4245065</span></span>
<span><span class="co">#&gt; 2    Denoised Space 0.1807910 0.2867278 0.05159743 0.6616748</span></span></code></pre></div>
<p>This table shows the total, positive, negative, and dark causality
values for each method, allowing you to compare the impact of using
custom functions.</p>
<p>This vignette has demonstrated how to use custom functions to enhance
the <code>patterncausality</code> analysis. By defining your own
distance metrics and state space reconstruction methods, you can tailor
the analysis to your specific needs and gain deeper insights into the
causal relationships in your data. Remember to validate the output of
your custom functions to ensure they are compatible with the
<code>patterncausality</code> package.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Stavros Stavroglou, Athanasios Pantelous, Hui Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
